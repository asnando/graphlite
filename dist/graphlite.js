!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.graphlite=t():e.graphlite=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){const r=n(12),o=n(13),s=n(2),a=n(7),i=n(14),c=n(8),l=n(15),u=n(9),h=n(16),p=n(5),f=n(17),g=n(18),b=n(19),d=n(6),y=n(20),m=n(21),v=n(22),w=n(23),$=n(24),x=n(25),j=n(26),O=n(27),T=n(28),k=n(30);e.exports={jtree:r,createHashCode:o,type:s,isArray:a,isBoolean:i,isNumber:c,isString:l,isObject:u,isFunction:h,isDef:p,quote:f,pbcopy:g,xtend:b,keys:d,defaults:y,pickBy:m,equals:v,copy:w,jpretty:$,omit:x,get:j,set:O,glob:T,query:k}},function(e,t,n){e.exports={debug:n(32),log:n(33),alert:n(44),warn:n(45),error:n(46),success:n(47)}},function(e,t){e.exports=function(e){return Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase()}},function(e,t,n){"use strict";(function(t){const r=n(35),o=n(36),s=n(41).stdout,a=n(42),i="win32"===t.platform&&!(Object({WEBPACK_ENV:!0}).TERM||"").toLowerCase().startsWith("xterm"),c=["ansi","ansi","ansi256","ansi16m"],l=new Set(["gray"]),u=Object.create(null);function h(e,t){t=t||{};const n=s?s.level:0;e.level=void 0===t.level?n:t.level,e.enabled="enabled"in t?t.enabled:e.level>0}function p(e){if(!this||!(this instanceof p)||this.template){const t={};return h(t,e),t.template=function(){const e=[].slice.call(arguments);return function(e,t){if(!Array.isArray(t))return[].slice.call(arguments,1).join(" ");const n=[].slice.call(arguments,2),r=[t.raw[0]];for(let e=1;e<t.length;e++)r.push(String(n[e-1]).replace(/[{}\\]/g,"\\$&")),r.push(String(t.raw[e]));return a(e,r.join(""))}.apply(null,[t.template].concat(e))},Object.setPrototypeOf(t,p.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=p,t.template}h(this,e)}i&&(o.blue.open="[94m");for(const e of Object.keys(o))o[e].closeRe=new RegExp(r(o[e].close),"g"),u[e]={get(){const t=o[e];return g.call(this,this._styles?this._styles.concat(t):[t],this._empty,e)}};u.visible={get(){return g.call(this,this._styles||[],!0,"visible")}},o.color.closeRe=new RegExp(r(o.color.close),"g");for(const e of Object.keys(o.color.ansi))l.has(e)||(u[e]={get(){const t=this.level;return function(){const n={open:o.color[c[t]][e].apply(null,arguments),close:o.color.close,closeRe:o.color.closeRe};return g.call(this,this._styles?this._styles.concat(n):[n],this._empty,e)}}});o.bgColor.closeRe=new RegExp(r(o.bgColor.close),"g");for(const e of Object.keys(o.bgColor.ansi)){if(l.has(e))continue;u["bg"+e[0].toUpperCase()+e.slice(1)]={get(){const t=this.level;return function(){const n={open:o.bgColor[c[t]][e].apply(null,arguments),close:o.bgColor.close,closeRe:o.bgColor.closeRe};return g.call(this,this._styles?this._styles.concat(n):[n],this._empty,e)}}}}const f=Object.defineProperties(()=>{},u);function g(e,t,n){const r=function(){return function(){const e=arguments,t=e.length;let n=String(arguments[0]);if(0===t)return"";if(t>1)for(let r=1;r<t;r++)n+=" "+e[r];if(!this.enabled||this.level<=0||!n)return this._empty?"":n;const r=o.dim.open;i&&this.hasGrey&&(o.dim.open="");for(const e of this._styles.slice().reverse())n=(n=e.open+n.replace(e.closeRe,e.open)+e.close).replace(/\r?\n/g,`${e.close}$&${e.open}`);return o.dim.open=r,n}.apply(r,arguments)};r._styles=e,r._empty=t;const s=this;return Object.defineProperty(r,"level",{enumerable:!0,get:()=>s.level,set(e){s.level=e}}),Object.defineProperty(r,"enabled",{enumerable:!0,get:()=>s.enabled,set(e){s.enabled=e}}),r.hasGrey=this.hasGrey||"gray"===n||"grey"===n,r.__proto__=f,r}Object.defineProperties(p.prototype,u),e.exports=p(),e.exports.supportsColor=s,e.exports.default=e.exports}).call(this,n(34))},function(e,t,n){const r=n(43);e.exports=function(e){let t="\n";for(let e=0;e<r+1;e++)t+=" ";e=[e=e.replace(/\n/g,t)];for(let t=0;t<r-1;t++)e.unshift(" ");return e.join(" ")}},function(e,t){e.exports=function(e){return null!=e}},function(e,t){e.exports=function(e){return Object.keys(e)}},function(e,t,n){const r=n(2);e.exports=function(e){return"array"===r(e)}},function(e,t,n){const r=n(2);e.exports=function(e){return"number"===r(e)}},function(e,t,n){const r=n(2);e.exports=function(e){return"object"===r(e)}},function(e,t,n){var r=n(39),o={};for(var s in r)r.hasOwnProperty(s)&&(o[r[s]]=s);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var i in a)if(a.hasOwnProperty(i)){if(!("channels"in a[i]))throw new Error("missing channels property: "+i);if(!("labels"in a[i]))throw new Error("missing channel labels property: "+i);if(a[i].labels.length!==a[i].channels)throw new Error("channel and label counts mismatch: "+i);var c=a[i].channels,l=a[i].labels;delete a[i].channels,delete a[i].labels,Object.defineProperty(a[i],"channels",{value:c}),Object.defineProperty(a[i],"labels",{value:l})}a.rgb.hsl=function(e){var t,n,r=e[0]/255,o=e[1]/255,s=e[2]/255,a=Math.min(r,o,s),i=Math.max(r,o,s),c=i-a;return i===a?t=0:r===i?t=(o-s)/c:o===i?t=2+(s-r)/c:s===i&&(t=4+(r-o)/c),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+i)/2,[t,100*(i===a?0:n<=.5?c/(i+a):c/(2-i-a)),100*n]},a.rgb.hsv=function(e){var t,n,r,o,s,a=e[0]/255,i=e[1]/255,c=e[2]/255,l=Math.max(a,i,c),u=l-Math.min(a,i,c),h=function(e){return(l-e)/6/u+.5};return 0===u?o=s=0:(s=u/l,t=h(a),n=h(i),r=h(c),a===l?o=r-n:i===l?o=1/3+t-r:c===l&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*s,100*l]},a.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[a.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-o)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=o[e];if(t)return t;var n,s,a,i=1/0;for(var c in r)if(r.hasOwnProperty(c)){var l=r[c],u=(s=e,a=l,Math.pow(s[0]-a[0],2)+Math.pow(s[1]-a[1],2)+Math.pow(s[2]-a[2],2));u<i&&(i=u,n=c)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],r=t[1],o=t[2];return r/=100,o/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},a.hsl.rgb=function(e){var t,n,r,o,s,a=e[0]/360,i=e[1]/100,c=e[2]/100;if(0===i)return[s=255*c,s,s];t=2*c-(n=c<.5?c*(1+i):c+i-c*i),o=[0,0,0];for(var l=0;l<3;l++)(r=a+1/3*-(l-1))<0&&r++,r>1&&r--,s=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[l]=255*s;return o},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=n,s=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,o*=s<=1?s:2-s,[t,100*(0===r?2*o/(s+o):2*n/(r+n)),100*((r+n)/2)]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,s=t-Math.floor(t),a=255*r*(1-n),i=255*r*(1-n*s),c=255*r*(1-n*(1-s));switch(r*=255,o){case 0:return[r,c,a];case 1:return[i,r,a];case 2:return[a,r,c];case 3:return[a,i,r];case 4:return[c,a,r];case 5:return[r,a,i]}},a.hsv.hsl=function(e){var t,n,r,o=e[0],s=e[1]/100,a=e[2]/100,i=Math.max(a,.01);return r=(2-s)*a,n=s*i,[o,100*(n=(n/=(t=(2-s)*i)<=1?t:2-t)||0),100*(r/=2)]},a.hwb.rgb=function(e){var t,n,r,o,s,a,i,c=e[0]/360,l=e[1]/100,u=e[2]/100,h=l+u;switch(h>1&&(l/=h,u/=h),r=6*c-(t=Math.floor(6*c)),0!=(1&t)&&(r=1-r),o=l+r*((n=1-u)-l),t){default:case 6:case 0:s=n,a=o,i=l;break;case 1:s=o,a=n,i=l;break;case 2:s=l,a=n,i=o;break;case 3:s=l,a=o,i=n;break;case 4:s=o,a=l,i=n;break;case 5:s=n,a=l,i=o}return[255*s,255*a,255*i]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},a.xyz.rgb=function(e){var t,n,r,o=e[0]/100,s=e[1]/100,a=e[2]/100;return n=-.9689*o+1.8758*s+.0415*a,r=.0557*o+-.204*s+1.057*a,t=(t=3.2406*o+-1.5372*s+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(e){var t,n,r,o=e[0];t=e[1]/500+(n=(o+16)/116),r=n-e[2]/200;var s=Math.pow(n,3),a=Math.pow(t,3),i=Math.pow(r,3);return n=s>.008856?s:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=i>.008856?i:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},a.lab.lch=function(e){var t,n=e[0],r=e[1],o=e[2];return(t=360*Math.atan2(o,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+o*o),t]},a.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var s=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(s+=60),s},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map(function(e){return e+e}).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255,s=Math.max(Math.max(n,r),o),a=Math.min(Math.min(n,r),o),i=s-a;return t=i<=0?0:s===n?(r-o)/i%6:s===r?2+(o-n)/i:4+(n-r)/i+4,t/=6,[360*(t%=1),100*i,100*(i<1?a/(1-i):0)]},a.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,o=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o,s=[0,0,0],a=t%1*6,i=a%1,c=1-i;switch(Math.floor(a)){case 0:s[0]=1,s[1]=i,s[2]=0;break;case 1:s[0]=c,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=i;break;case 3:s[0]=0,s[1]=c,s[2]=1;break;case 4:s[0]=i,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=c}return o=(1-n)*r,[255*(n*s[0]+o),255*(n*s[1]+o),255*(n*s[2]+o)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,n){const r=n(0),o=n(31),s=n(49);n(1);e.exports=class{constructor(e){this._connection=e.connection,this._schema=r.defaults(e.schema,[],e=>e.map(e=>this.defineSchema(e))),this._queries=r.defaults(e.queries,[],e=>e.map(e=>this.defineQuery(e))),this._options={}}_schemaProvider(e){return this._schema.find(t=>t.name===e)}findAll(e,t={},n={}){n=Object.assign({},{page:n.page,size:n.size},t);const r=this._queries.find(t=>t.name===e);if(!r)throw new Error(`Undefined "${e}" query.`);let o,s,a,i;s=Date.now();try{o=r.build(n),r.parseResponse(),a=(Date.now()-s)/1e3}catch(e){throw new Error(`Caught an error building the query:\n\t${e}`)}return s=Date.now(),this.executeBuildedQuery(o).then(e=>(e=r.parseResponse(e),i=(Date.now()-s)/1e3,{rows:e,buildedIn:a,executedIn:i,parsedIn:0}))}defineSchema(e,t){t=r.isObject(e)?e:t,e=r.isObject(e)?e.name:e;const n=new o(e,t);return this._schema.push(n),n}defineQuery(e,t){const n=this._schemaProvider.bind(this);t=r.isObject(e)?e:t,e=r.isObject(e)?e.name:e;const o=new s(e,t,n);return this._queries.push(o),o}executeBuildedQuery(e){return this._connection.run(e).then(this.parseResponse)}parseResponse(e){return e.map(e=>JSON.parse(e.response))}executeRawQuery(e){return this.connection.run(e)}}},function(e,t,n){const r=n(7),o=n(8),s=n(9);e.exports=function e(t,n,a,i,c,l){a=a||"$",l=l||{},"function"==typeof n&&(l=n(t,a,l,i,c)),r(t)?t.forEach((r,o)=>{e(r,n,a.concat("#").concat(o),t,a,l)}):s(t)&&Object.keys(t).forEach(r=>{o(r)||e(t[r],n,a.concat(".").concat(r),t,a,l)})}},function(e,t){e.exports=function e(){let t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);return/^\d/.test(t)?e():t}},function(e,t,n){n(2);e.exports=function(e){return"boolean"==typeof e}},function(e,t,n){const r=n(2);e.exports=function(e){return"string"===r(e)}},function(e,t,n){const r=n(2);e.exports=function(e){return"function"===r(e)}},function(e,t){e.exports=function(e){return`'${e}'`}},function(e,t,n){e.exports=function(e){}},function(e,t){e.exports=function(){var e=[].slice.call(arguments),t=e.shift()||{};return e.forEach(function(e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}),t}},function(e,t,n){const r=n(5);e.exports=function(e,t,n){return r(e)&&r(n)?n(e):r(e)?e:t}},function(e,t,n){const r=n(5);e.exports=function(e){for(key in e)r(e[key])||delete e[key];return e}},function(e,t){e.exports=function(e,t){return e===t}},function(e,t){e.exports=function(e){return{...e}}},function(e,t){e.exports=function(e,t=2){return JSON.stringify(e,null,t)}},function(e,t){e.exports=function(e,t){return t.forEach(t=>delete e[t]),e}},function(e,t){e.exports=function(e,t){for(var n=e,r=t.split("."),o=r.length,s=0;s<o-1;s++){var a=r[s];n[a]||(n[a]={}),n=n[a]}return n[r[o-1]]}},function(e,t){e.exports=function(e,t,n){for(var r=e,o=t.split("."),s=o.length,a=0;a<s-1;a++){var i=o[a];r[i]||(r[i]={}),r=r[i]}r[o[s-1]]=n}},function(e,t,n){const r=n(6),o=n(29);e.exports=function(e){const t={a:"[AÁÀÂÄÃªaáàâäã]",e:"[EÉÈÊËeéèêë]",i:"[IÍÌÎÏiíìîï]",o:"[OÓÒÔÖÕºoóòôöõ]",u:"[UÚÙÛÜuúùûü]",c:"[CÇcç]"};e=o(e);const n=r(t);return"*"+e.split("").map(e=>n.includes(e)?t[e]:`[${e.toUpperCase()}${e}]`).join("")+"*"}},function(e,t,n){const r=n(6);e.exports=function(e){const t={a:["á","à","â","","ã","ª"],e:["é","è","ê",""],i:["í","ì","î",""],o:["ó","ò","ô","","õ","º"],u:["ú","ù","û",""],c:["ç"]};e=e.toLowerCase();const n=r(t);for(let r=0;r<e.length;r++){const o=e.charAt(r);n.forEach(n=>{t[n].includes(o)&&(e=e.replace(e.charAt(r),n))})}return e}},function(e,t,n){e.exports=function(e){return e}},function(e,t,n){const r=n(1),o=n(0),s=n(48);function a(e){return o.keys(e.belongsToManyRelations).concat(o.keys(e.belongsToOneRelation))}e.exports=class{constructor(e,t){this.name=e,this.tableName=t.tableName,this.hash=o.createHashCode(),this.properties=this._createSchemaProperties(t.properties),this.hasManyRelationsWith={},this.hasOneRelationWith={},this.belongsToOneRelation={},this.belongsToManyRelations={}}_createSchemaProperties(e){return(e=o.keys(e).map(t=>this._createSchemaProperty(t,e[t]))).find(e=>"primaryKey"===e.type)||r.warn(`[WARN] Missing primary key for "${this.name}" schema.`),e}_createSchemaProperty(e,t){const n=o.isString(t)?t:t.type?t.type:"default",r=o.pickBy({name:e,type:n,alias:t.alias,resolver:t.resolve,join:t.join,parser:t.parser});return"primaryKey"===n&&(this.primaryKey=r.name),r}_createAssociation(e,t,n){/^has/.test(n);const r=/^belongs/.test(n);return new s({targetHash:r?this.hash:e.hash,targetTable:r?this.tableName:e.tableName,targetKey:r?this.primaryKey:e.primaryKey,sourceHash:r?e.hash:this.hash,sourceTable:r?e.tableName:this.tableName,sourceKey:r?e.primaryKey:this.primaryKey,foreignTable:t.foreignTable,foreignKey:t.foreignKey,objectType:/many/i.test(n)?"array":"object",associationType:n,grouped:t.grouped})}hasMany(e,t={}){this.hasManyRelationsWith[e.name]=this._createAssociation(e,t,"hasMany")}hasOne(e,t={}){this.hasOneRelationWith[e.name]=this._createAssociation(e,t,"hasOne")}belongsTo(e,t={}){this.belongsToOneRelation[e.name]=this._createAssociation(e,t,"belongsTo");const n=e.hasManyRelationsWith[this.name]||e.hasOneRelationWith[this.name];n&&n.extendOptions(t)}belongsToMany(e,t={}){this.belongsToManyRelations[e.name]=this._createAssociation(e,t,"belongsToMany");const n=e.hasManyRelationsWith[this.name]||e.hasOneRelationWith[this.name];n&&n.extendOptions(t)}haveAssociationWithParent(e){return!(!this._getDirectAssociationWith(e)&&!this._getRelatedAssociationWith(e))}getAssociationWithParent(e){return this._getDirectAssociationWith(e)||this._getRelatedAssociationWith(e)}getAssociationFromParent(e){return this.getAssociationFrom(e.name)}_getDirectAssociationWith(e){return a(this).includes(e.name)?this.belongsToManyRelations[e.name]||this.belongsToOneRelation[e.name]:null}_getRelatedAssociationWith(e){const t=a(this),n=function(e){return o.keys(e.hasManyRelationsWith).concat(o.keys(e.hasOneRelationWith))}(e).find(e=>t.includes(e));if(!n)return null;const r=e.hasManyRelationsWith[n]||e.hasOneRelationWith[n];function i(e){return new s({sourceHash:e.sourceHash,sourceTable:e.sourceTable,sourceKey:e.sourceKey,targetHash:this.hash,targetTable:this.tableName,targetKey:this.primaryKey,throught:e,associationType:e.associationType,objectType:e.objectType})}return e.hasManyRelationsWith[n]&&(this.belongsToManyRelations[e.name]=i.call(this,r)),e.hasOneRelationWith[n]&&(this.belongsToOneRelation[e.name]=i.call(this,r)),this.getAssociationWith(e.name)}getAssociationFrom(e){return this.hasManyRelationsWith[e]||this.hasOneRelationWith[e]}getAssociationWith(e){return this.belongsToManyRelations[e]||this.belongsToOneRelation[e]}}},function(e,t){e.exports=Object({WEBPACK_ENV:!0}).WEBPACK?function(){}:console.log},function(e,t,n){n(3),n(4);e.exports=function(){Array.from(arguments).map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" ")}},function(e,t){var n,r,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,l=[],u=!1,h=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var e=i(p);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function b(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||u||i(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=b,o.addListener=b,o.once=b,o.off=b,o.removeListener=b,o.removeAllListeners=b,o.emit=b,o.prependListener=b,o.prependOnceListener=b,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var r=/[|\\{}()[\]^$+*?.]/g;e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(r,"\\$&")}},function(e,t,n){"use strict";(function(e){const t=n(38),r=(e,n)=>(function(){return`[${e.apply(t,arguments)+n}m`}),o=(e,n)=>(function(){const r=e.apply(t,arguments);return`[${38+n};5;${r}m`}),s=(e,n)=>(function(){const r=e.apply(t,arguments);return`[${38+n};2;${r[0]};${r[1]};${r[2]}m`});Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,n={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};n.color.grey=n.color.gray;for(const t of Object.keys(n)){const r=n[t];for(const t of Object.keys(r)){const o=r[t];n[t]={open:`[${o[0]}m`,close:`[${o[1]}m`},r[t]=n[t],e.set(o[0],o[1])}Object.defineProperty(n,t,{value:r,enumerable:!1}),Object.defineProperty(n,"codes",{value:e,enumerable:!1})}const a=e=>e,i=(e,t,n)=>[e,t,n];n.color.close="[39m",n.bgColor.close="[49m",n.color.ansi={ansi:r(a,0)},n.color.ansi256={ansi256:o(a,0)},n.color.ansi16m={rgb:s(i,0)},n.bgColor.ansi={ansi:r(a,10)},n.bgColor.ansi256={ansi256:o(a,10)},n.bgColor.ansi16m={rgb:s(i,10)};for(let e of Object.keys(t)){if("object"!=typeof t[e])continue;const a=t[e];"ansi16"===e&&(e="ansi"),"ansi16"in a&&(n.color.ansi[e]=r(a.ansi16,0),n.bgColor.ansi[e]=r(a.ansi16,10)),"ansi256"in a&&(n.color.ansi256[e]=o(a.ansi256,0),n.bgColor.ansi256[e]=o(a.ansi256,10)),"rgb"in a&&(n.color.ansi16m[e]=s(a.rgb,0),n.bgColor.ansi16m[e]=s(a.rgb,10))}return n}})}).call(this,n(37)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(10),o=n(40),s={};Object.keys(r).forEach(function(e){s[e]={},Object.defineProperty(s[e],"channels",{value:r[e].channels}),Object.defineProperty(s[e],"labels",{value:r[e].labels});var t=o(e);Object.keys(t).forEach(function(n){var r=t[n];s[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),s[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)})}),e.exports=s},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){var r=n(10);function o(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,o=0;o<n;o++)e[t[o]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var o=n.pop(),s=Object.keys(r[o]),a=s.length,i=0;i<a;i++){var c=s[i],l=t[c];-1===l.distance&&(l.distance=t[o].distance+1,l.parent=o,n.unshift(c))}return t}function s(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],o=r[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),o=s(r[t[a].parent][a],o),a=t[a].parent;return o.conversion=n,o}e.exports=function(e){for(var t=o(e),n={},r=Object.keys(t),s=r.length,i=0;i<s;i++){var c=r[i];null!==t[c].parent&&(n[c]=a(c,t))}return n}},function(e,t,n){"use strict";e.exports={stdout:!1,stderr:!1}},function(e,t,n){"use strict";const r=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,o=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,s=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,a=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi,i=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function c(e){return"u"===e[0]&&5===e.length||"x"===e[0]&&3===e.length?String.fromCharCode(parseInt(e.slice(1),16)):i.get(e)||e}function l(e,t){const n=[],r=t.trim().split(/\s*,\s*/g);let o;for(const t of r)if(isNaN(t)){if(!(o=t.match(s)))throw new Error(`Invalid Chalk template style argument: ${t} (in style '${e}')`);n.push(o[2].replace(a,(e,t,n)=>t?c(t):n))}else n.push(Number(t));return n}function u(e){o.lastIndex=0;const t=[];let n;for(;null!==(n=o.exec(e));){const e=n[1];if(n[2]){const r=l(e,n[2]);t.push([e].concat(r))}else t.push([e])}return t}function h(e,t){const n={};for(const e of t)for(const t of e.styles)n[t[0]]=e.inverse?null:t.slice(1);let r=e;for(const e of Object.keys(n))if(Array.isArray(n[e])){if(!(e in r))throw new Error(`Unknown Chalk style: ${e}`);r=n[e].length>0?r[e].apply(r,n[e]):r[e]}return r}e.exports=((e,t)=>{const n=[],o=[];let s=[];if(t.replace(r,(t,r,a,i,l,p)=>{if(r)s.push(c(r));else if(i){const t=s.join("");s=[],o.push(0===n.length?t:h(e,n)(t)),n.push({inverse:a,styles:u(i)})}else if(l){if(0===n.length)throw new Error("Found extraneous } in Chalk template literal");o.push(h(e,n)(s.join(""))),s=[],n.pop()}else s.push(p)}),o.push(s.join("")),n.length>0){const e=`Chalk template literal is missing ${n.length} closing bracket${1===n.length?"":"s"} (\`}\`)`;throw new Error(e)}return o.join("")})},function(e,t){e.exports=3},function(e,t,n){n(3),n(4);e.exports=function(){Array.from(arguments).map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" ")}},function(e,t,n){n(3),n(4);e.exports=function(){Array.from(arguments).map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" ")}},function(e,t,n){n(3),n(4);e.exports=function(){Array.from(arguments).map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" ")}},function(e,t,n){n(3),n(4);e.exports=function(){Array.from(arguments).map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" ")}},function(e,t,n){const r=n(0);n(1);e.exports=class{constructor(e={}){r.xtend(this,{sourceHash:e.sourceHash,sourceTable:e.sourceTable,sourceKey:e.sourceKey,targetHash:e.targetHash,targetTable:e.targetTable,targetKey:e.targetKey,foreignTable:e.foreignTable,foreignKey:e.foreignKey,associationType:e.associationType,objectType:e.objectType,throught:e.throught,grouped:!!e.grouped})}extendOptions(e){r.keys(e).length&&r.xtend(this,e)}}},function(e,t,n){const r=n(1),o=n(0),s=n(50),a=n(53),i=n(54),c=n(55),l=n(56),u=n(57);e.exports=class{constructor(e,t,n){this.name=e,this.rawGraph=t,this.schemaProvider=n,this.graph=this._resolveGraph(this.rawGraph),this.responseParser=new i(this.graph)}_resolveGraph(e){let t=new s;const n=this.schemaProvider;return o.jtree(e,(e,r,s)=>{if(/^\$$/.test(r)||/(?<=\.(where|shows)\.)\w+$/.test(r)||/(?<=\.options)/.test(r)||/(shows|options|alias|properties|\d|where|groupBy|size|page|orderBy|type)$/.test(r))return;const i=e.alias||p(r),h=n(i);if(!h)throw new Error(`Could not detect schema configuration for "${i}".`);function p(e){return e.split(".").pop()}const f=function(e){return 1===e.match(/\./g).length?null:e.match(/(\w+)\.\w+$/)[1]}(r),g=s.parent,b=!!g;if(b&&!h.haveAssociationWithParent(g))throw new Error(`"${h.name}" have no relation with "${f}".`);const d=new a({name:h.name,alias:e.alias&&p(r),hash:h.hash,tableName:h.tableName,properties:e.properties,schemaProperties:h.properties,primaryKey:h.primaryKey,options:e.where,shows:e.shows,staticOptions:{page:e.page,size:e.size,orderBy:e.orderBy,groupBy:e.groupBy},parentAssociation:function(e,t){if(!b)return null;const n=t.getAssociationFromParent(e),r=e.getAssociationWithParent(t);return function(e={},t={}){return o.xtend(e,t)}(r,{objectType:n?n.objectType:r.objectType,grouped:n?n.grouped:r.grouped})}(h,g)}),y=t.addNode(h.hash,d,s.lastNodeHash);return y.createResolver("main",c,!0),y.createResolver("filterId",l,!1,""),y.createResolver("options",u),{lastNodeHash:h.hash,lastNodeName:h.name,parent:h}}),t}build(e={}){return r.warn(`Building query "${this.name}" with options: ${o.jpretty(e)}`),this.graph.resolve("main",e)}parseResponse(e){return this.responseParser.parse(e)}}},function(e,t,n){n(0),n(1);const r=n(51);e.exports=class{constructor(){this.head=null,this.tail=null,this.graph={}}addNode(e,t,n,o){return this.head=this.head||e,t=new r({nodeHash:e,resolvers:o,node:t}),this.graph[e]=t,this.tail&&(t.setPreviousNode(this.getNode(n||this.tail)),this.getNode(n||this.tail).addNextNode(t)),this.tail=e,t}getNode(e){return this.graph[e]}getRawNode(e){return this.graph[e].raw()}getHeadNode(){return this.graph[this.getHeadNodeHash()]}getTailNode(){return this.graph[this.getTailNodeHash()]}getHeadNodeHash(){return this.head}getTailNodeHash(){return this.tail}resolve(e,t){return this.getHeadNode().resolve(e,t)}walk(e){return this.getHeadNode().walk(e)}}},function(e,t,n){const r=n(0),o=(n(1),n(52));e.exports=class{constructor(e){this.prevNode=null,this.nextNodes=[],this.node=e.node,this.resolvers={}}getParent(){return this.prevNode?this.prevNode():null}setPreviousNode(e){return this.prevNode=e}addNextNode(e){return this.nextNodes.push(e)}resolve(e,t){if(!this.resolvers[e])throw new Error(`Undefined resolver "${e}".`);return this.resolvers[e].resolve(this,t)}raw(){return this.node}createResolver(e,t,n,r){this.resolvers[e]=new o(e,t,n,r)}walk(e){e(this.raw()),this.nextNodes.length&&this.nextNodes.forEach(t=>{r.isFunction(t.walk)&&t.walk(e)})}}},function(e,t,n){const r=n(0);n(1);e.exports=class{constructor(e,t,n=!1,r="json_object()"){this.name=e,this.resolver=t,this.usePatch=n,this.defaultValue=r}resolve(e,t){return this.resolver(e.raw(),t,this.resolveNextNodes.bind(this,e,t),e.resolve.bind(e))}resolveNextNodes(e,t){const n=e.nextNodes;if(!n.length)return this.defaultValue;n.length%2&&n.push(()=>this.defaultValue);let o=n.map(e=>r.isFunction(e)?e():e.resolve(this.name,t)).map(e=>this.usePatch?`(${e})`:e).join(this.usePatch?",":" ");return this.usePatch&&(o=`select json_patch(${o})`),o}}},function(e,t,n){const r=n(0),o=(n(1),"response"),s="object",a=100;e.exports=class{constructor(e={}){r.xtend(this,{name:e.name,alias:e.alias,hash:e.hash,properties:e.properties,schemaProperties:r.defaults(e.schemaProperties,[]),definedProperties:this._resolvePropertiesDefinition(e.schemaProperties,e.properties),tableName:e.tableName,primaryKey:e.primaryKey,parentAssociation:e.parentAssociation,definedOptions:r.defaults(e.options,{}),staticOptions:e.staticOptions,nodeOptions:r.defaults(e.shows,{})})}_resolvePropertiesDefinition(e,t){function n(e,t){return t.find(t=>t.name===e)}return!t||r.isString(t)?e:t.filter(t=>n(t,e)).map(t=>n(t,e))}getTableName(){return this.tableName}getTableAlias(){return this.hash}getObjectType(){return this.parentAssociation?this.parentAssociation.objectType:s}getPrimaryKey(){return this.primaryKey}getFieldsAsJson(){const e=this.getTableAlias();return this.definedProperties.filter(e=>!this.parentAssociation||"primaryKey"!==e.type).map(t=>{let n,o="primaryKey"===t.type?"_id":t.name;switch(n=t.resolver?"(CASE"+t.resolver.map(t=>` WHEN ${e}.${t} IS NOT NULL THEN ${e}.${t}`).join(" ")+" END)":t.join?t.join.join(" || "):e.concat(".").concat(t.alias||t.name),t.type){case"boolean":n=`(CASE WHEN ${n} IS NOT NULL AND ${n}<>0 THEN 1 ELSE 0 END)`;break;case"integer":n=`cast(${n} as integer)`;break;case"number":n=`cast(${n} as real)`}return[r.quote(o),n].join(",")}).join(",")}getResponseObjectName(){return this.parentAssociation?"":o}getRawFields(){return`${this.getTableName()}.*`}getSource(){return`FROM ${this.getTableName()} ${this.getAssociation()}`}getAssociation(){const e=this.parentAssociation;return e?e.foreignTable&&e.foreignKey?`INNER JOIN ${e.foreignTable} ON ${e.foreignTable}.${e.sourceKey}=${e.sourceHash}.${e.sourceKey} WHERE ${e.targetTable}.${e.foreignKey}=${e.foreignTable}.${e.targetKey}`:`WHERE ${e.targetTable}.${e.targetKey}=${e.sourceHash}.${e.targetKey}`:""}getJoin(){const e=this.parentAssociation;return e.foreignTable&&e.foreignKey?`INNER JOIN ${e.foreignTable} ON ${e.foreignTable}.${e.sourceKey}=${e.sourceTable}.${e.sourceKey} INNER JOIN ${e.targetTable} ON ${e.targetTable}.${e.foreignKey}=${e.foreignTable}.${e.targetKey}`:`INNER JOIN ${e.targetTable} ON ${e.targetTable}.${e.targetKey}=${e.sourceTable}.${e.targetKey}`}getShowOptions(e){return(e=this.resolveOptionsWithValues(this.nodeOptions,e)).length?`AND ${e.join(" AND ")}`:""}getOptions(e={},t=[]){const n=this,o={where:function(e){return e&&e.length?" WHERE ".concat(e.join(" AND ")):""}(this.resolveOptionsWithValues(this.definedOptions,e)),group:(c=this.staticOptions.groupBy,c&&c.length?" GROUP BY "+c.map(e=>{if(!(e=n.getSchemaPropertyConfig(e)))throw new Error(`Undefined "${e}" property configuration on "${n.name}" schema for grouping.`);return e.alias||e.name}).map(e=>n.getTableName().concat(".").concat(e)):""),order:(i=this.staticOptions.orderBy,i&&i.length?" ORDER BY "+i.map(e=>{if(!(e=n.getSchemaPropertyConfig(e)))throw new Error(`Undefined "${e}" property configuration on "${n.name}" schema for ordering.`);return e.alias||e.name}).map(e=>n.getTableName().concat(".").concat(e)):""),limit:(s=e.size||this.staticOptions.size,!s&&n.parentAssociation?"":`LIMIT ${s||a}`),offset:function(e,t){return e&&t?" OFFSET ".concat((e-1)*t):""}(e.page||this.staticOptions.page,e.size||this.staticOptions.size)};var s,i,c;return t.length?t.map(e=>o[e]).join(" "):r.keys(o).map(e=>o[e]).join(" ")}resolveOptionsWithValues(e,t){const n=r.keys(t).filter(t=>!!e.hasOwnProperty(t));return n.length?n.map(n=>{const o=e[n].replace(/\W/g,""),s=this.schemaProperties.find(e=>e.name===o),a=e[n],i=t[n],c=s.alias||s.name,l=/\W/.test(a)?a.match(/\W/)[0]:"=";if(!s)throw new Error(`"${o}" property from where clause not found in "${this.name}" schema properties.`);return{name:c,definition:a,value:i,operator:l,resolve:function(){const e=this.operator,t=this.value;switch(e){case"=":return`=${r.quote(t)}`;case"<>":return`<>${r.quote(t)}`;case">":return`>${t}`;case"<":return`<${t}`;case"%":return`LIKE ${r.quote(t)}`;case"#":return`GLOB ${r.quote(r.glob(t))}`;default:return""}}}}).map(e=>`${this.getTableName()}.${e.name} ${e.resolve()}`):""}getSchemaPropertyConfig(e){return this.schemaProperties.find(t=>t.name===e)}getAssociationName(){return r.quote(this.name)}getDistinctPrimaryKey(){return`DISTINCT ${this.getTableName()}.${this.getPrimaryKey()}`}}},function(e,t,n){const r=n(0);n(1);e.exports=class{constructor(e){this.shadow=this.createShadowFromGraph(e)}createShadowFromGraph(e){let t,n={};return e.walk(e=>{const c=e.parentAssociation,l=c?c.objectType:"object";t=t?"array"===l?t.concat(".").concat(e.name):t:"$","array"===l&&(n[t]=o.bind(this,[i])),e.definedProperties.filter(e=>"primaryKey"!==e.type||!c).map(e=>{const n=[],i="primaryKey"===e.type?"_id":e.name;switch(e.type){case"boolean":n.push(a);break;case"number":n.push(s)}r.isFunction(e.parser)&&n.push(e.parser);const c=t.concat(".").concat(i);return n.length?{[c]:o.bind(this,n)}:{}}).forEach(e=>{n=r.xtend(n,e)})}),n}parse(e){return e&&e.length?e.map(e=>(r.keys(this.shadow).forEach(t=>{const n=this.shadow[t];t=t.replace(/^\$\./,"");const o=n(r.get(e,t));r.set(e,t,o)}),e)):[]}};const o=function(e,t){return e&&e.length?(e.forEach(e=>t=e(t)),t):t};function s(e){return parseInt(e)}function a(e){return!!e}function i(e){return e.filter(e=>e)}},function(e,t,n){const r=n(0);n(1);e.exports=function(e,t={},n,o){const s="object"===e.getObjectType()?"select json_patch(json_object($fields_as_json), ($next_nodes)) $object_name from (select $raw_fields $source $show_options $options) $table_alias":"(select json_object($node_name, (select json_group_array(json_patch(json_object($fields_as_json), ($next_nodes))) from (select $raw_fields $source $show_options $options) $table_alias)))";let a=e.getOptions(t,["group","order","limit","offset"]);e.parentAssociation||(a=a.replace(/LIMIT\s\d+/,"").replace(/OFFSET\s\d+/,""));let i=s.replace(/\$table_alias/,e.getTableAlias()).replace(/\$raw_fields/,e.getRawFields()).replace(/\$source/,e.getSource()).replace(/\$fields_as_json/,e.getFieldsAsJson()).replace(/\$object_name/,e.getResponseObjectName()).replace(/\$node_name/,e.getAssociationName()).replace(/\$next_nodes/,n(t)).replace(/\$show_options/,e.getShowOptions(t)).replace(/\$options/,a);if(!e.parentAssociation){const n=o("filterId",t);i+=` WHERE ${e.getTableAlias()}.${e.getPrimaryKey()} IN (${n})`}return i=r.query(i),e.parentAssociation||r.pbcopy(i),i}},function(e,t,n){n(0),n(1);e.exports=function(e,t,n,r){const o=n().replace(/json_object\(\)/g,""),s=r("options",t).replace(/json_object\(\)/g,"");return e.parentAssociation?`${e.getJoin()} ${o}`:`SELECT ${e.getDistinctPrimaryKey()} ${e.getSource()} ${o} ${s} ${e.getOptions(t,["group","order","limit","offset"])}`}},function(e,t){e.exports=function(e,t,n){return e.getOptions(t,["where"])+n(t)}}])});
//# sourceMappingURL=graphlite.js.map